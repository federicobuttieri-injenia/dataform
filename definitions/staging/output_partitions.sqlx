config {
    type: "view",
    name: "output_partitions"
}

SELECT DISTINCT CAST((FLOOR((numero_case - 1) / 10000) * 10000) as INT64) + 1 AS number
FROM (
    SELECT DISTINCT a.numero_case AS numero_case
    FROM ${ref("S_LOG_CASE")}, UNNEST (attributes) a
    WHERE _PARTITIONDATE IN (
        SELECT *
        FROM ${ref("input_partitions")}
    )
)